{
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workbookDisplayName": {
            "type": "string",
            "defaultValue": "azmon-prod-wbok",
            "metadata": {
                "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
            }
        },
        "workbookType": {
            "type": "string",
            "defaultValue": "workbook",
            "metadata": {
                "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
            }
        },
        "workbookSourceId": {
            "type": "string",
            "defaultValue": "Azure Monitor",
            "metadata": {
                "description": "The id of resource instance to which the workbook will be associated"
            }
        },
        "workbookId": {
            "type": "string",
            "defaultValue": "[newGuid()]",
            "metadata": {
                "description": "The unique guid for this workbook instance"
            }
        }
    },
    "resources": [
        {
            "name": "[parameters('workbookId')]",
            "type": "microsoft.insights/workbooks",
            "location": "[resourceGroup().location]",
            "apiVersion": "2018-06-17-preview",
            "dependsOn": [],
            "kind": "shared",
            "properties": {
                "displayName": "[parameters('workbookDisplayName')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"crossComponentResources\":[\"value::all\"],\"parameters\":[{\"id\":\"b76970d6-be27-460b-a9ac-d3f0dc998763\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Workspace\",\"label\":\"Log Analytics Workspace\",\"type\":5,\"description\":\"Choose the Log Analytics Workspace\",\"isRequired\":true,\"query\":\"where type =~ 'microsoft.operationalinsights/workspaces'\\r\\n| project id\",\"crossComponentResources\":[\"value::all\"],\"value\":null,\"typeSettings\":{\"additionalResourceOptions\":[]},\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"6cfb5005-2b00-4d53-9847-965fe30c5f52\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ResourceGroup\",\"label\":\"VM Resource group\",\"type\":5,\"description\":\"Choose the Resource Group containing Virtual Machines\",\"isRequired\":true,\"query\":\"where type =~ \\\"microsoft.compute/virtualmachines\\\"\\r\\n| project resourceGroup\\r\\n| distinct resourceGroup\\r\\n\",\"crossComponentResources\":[\"value::all\"],\"value\":null,\"typeSettings\":{\"additionalResourceOptions\":[]},\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"3734d8d2-9524-4686-adaa-1615de21227a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Period\",\"type\":4,\"description\":\"Sets the timerange where not fixed in query.\",\"isRequired\":true,\"value\":{\"durationMs\":86400000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000}]},\"label\":\"Time range\"},{\"id\":\"d410eb76-01a2-4a9a-8bfa-2b10a7611f90\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"AvailRateOverDays\",\"type\":2,\"isRequired\":true,\"value\":\"2\",\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\r\\n    \\\"1\\\",\\r\\n    \\\"2\\\",\\r\\n    \\\"3\\\",\\r\\n    \\\"4\\\",\\r\\n    \\\"5\\\",\\r\\n    \\\"6\\\",\\r\\n    \\\"7\\\",\\r\\n    \\\"14\\\",\\r\\n    \\\"21\\\",\\r\\n    \\\"30\\\"\\r\\n]\",\"label\":\"Availability days\"},{\"id\":\"a3d09a5c-7b22-428f-951a-dc79b61d0cba\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Computername\",\"label\":\"Computername contains\",\"type\":1,\"value\":\"21\"}],\"style\":\"pills\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},\"name\":\"parameters - 2\"},{\"type\":1,\"content\":{\"json\":\"# AVAILABILITY\\r\\n---\\r\\nIn this section you can find 4 items.\\r\\n\\r\\n- **Computers reporting in -Time range-:** Timechart that shows how much computers are reporting to the log analytics workspace over the last -Time range-.\\r\\n- **Availability rate in the last 24 hours (sample rate 5 minutes):** Grid with availability percent per computer over the last 24 hours. Availability sample is taken every 5 minutes.\\r\\n- **Last Heartbeat > 5 minutes ago in the last 24 hours:** Grid showing all computers with a last heartbeat that is more than 5 minutes ago in the last 24 hours.\\r\\n- ** Availability percent over -Availability days- (sample rate 5 minutes):** Grid with availability percent per computer over the last -Availability days-. Availability sample is taken every 5 minutes.\\r\\n\"},\"name\":\"text - 0\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nHeartbeat \\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName \\r\\n| summarize Computers = dcount(ComputerIP) by bin(TimeGenerated, 1h)    \\r\\n| render timechart\",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"Computers reporting in -Time range-\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"Period\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"]},\"customWidth\":\"50\",\"name\":\"query - 5\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"// Availability rate\\n// Calculate the availability rate of each connected computer\\nlet ResourceGroupName = \\\"{ResourceGroup}\\\";\\nHeartbeat\\n| where Computer contains \\\"{Computername}\\\"\\n| where _ResourceId contains ResourceGroupName\\n| summarize heartbeatPerSample = count() by bin_at(TimeGenerated, 5m, ago(1d)), Computer\\n| extend availablePerSample = iff(heartbeatPerSample > 0, true, false)\\n| summarize Samples = countif(availablePerSample == true) by Computer\\n| extend Percent = round(Samples*100.0/(1*(60/5)*24))\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Availability percent in the last 24 hours (sample rate 5 minutes)\",\"exportFieldName\":\"Computer\",\"exportParameterName\":\"SelectedComputer\",\"exportDefaultValue\":\"NA\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Rate\",\"formatter\":18,\"formatOptions\":{\"showIcon\":true,\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"<\",\"thresholdValue\":\"85\",\"representation\":\"4\",\"text\":\"{0}{1}\"},{\"operator\":\"<\",\"thresholdValue\":\"95\",\"representation\":\"2\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":null,\"text\":\"{0}{1}\"}]}}],\"filter\":true}},\"customWidth\":\"50\",\"name\":\"AvailabilityRate\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nHeartbeat \\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName \\r\\n| summarize LastHeartbeat=max(TimeGenerated) by Computer \\r\\n| where LastHeartbeat < ago(5m)\",\"size\":0,\"showAnalytics\":true,\"title\":\"Last Heartbeat > 5 minutes ago in last 24 hours\",\"noDataMessage\":\"All computers are reporting normally.\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\"},\"customWidth\":\"50\",\"name\":\"query - 7\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nHeartbeat\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| summarize heartbeatPerSample = count() by bin_at(TimeGenerated, 5m, ago({AvailRateOverDays}d)), Computer\\r\\n| extend availablePerSample = iff(heartbeatPerSample > 0, true, false)\\r\\n| summarize Samples = countif(availablePerSample == true) by Computer\\r\\n| extend Percent = round(Samples*100.0/({AvailRateOverDays}*(60/5)*24))\",\"size\":0,\"showAnalytics\":true,\"title\":\"Availability percent over -Availability days- (sample rate 5 minutes)\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Rate\",\"formatter\":18,\"formatOptions\":{\"showIcon\":true,\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"<\",\"thresholdValue\":\"85\",\"representation\":\"4\",\"text\":\"{0}{1}\"},{\"operator\":\"<\",\"thresholdValue\":\"95\",\"representation\":\"2\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"success\",\"text\":\"{0}{1}\"}]}}]}},\"customWidth\":\"50\",\"name\":\"query - 18\"},{\"type\":1,\"content\":{\"json\":\"# PERFORMANCE\\r\\n---\\r\\nIn this section you can find the following.\\r\\n\\r\\n- **CPU % Total:** Average of CPU usage per computer sampled every 15 minutes. Note that values above 100% are possible because of multi processor systems. Also note that this graph has a time-brush system. The timeframe that you select (brush) in this graph is used in all other performance views.\\r\\n- **CPU Queue Length:** Average of CPU queue langth per computer sampled every 15 minutes.\\r\\n- **Memory Available Mbytes:** Average of available Mbytes per computer samples every 15 minutes.\\r\\n- **Pages/second:** Average of pages / second per computer sampled every 5 minutes.\\r\\n- **Free Space in MB:** Average free space in Mbytes per computer sampled every 15 minutes. The parameter above this view indicates which logical drive to report on.\\r\\n- **Disk queue length:** Average disk queue length per computer sampled every 15 minutes. The parameter above this view indicates which logical drive to report on.\\r\\n- **Bytes Received/sec:** Average bytes received per second sampled every 15 minutes. The parameter above this view indicates which network card to report on.\\r\\n- **Bytes sent/sec:** Average bytes sent per second sampled every 15 minutes. The parameter above this view indicates which network card to report on.\\r\\n- **Top 10 processes by CPU usage:** List of top 10 CPU users (average) per process. The computer being reported on can be selected in the *Availability rate in the last 24 hours* view. \\r\\n\"},\"name\":\"text - 10\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nPerf\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| where (CounterName == \\\"% Processor Time\\\" and InstanceName == \\\"_Total\\\")\\r\\n| project TimeGenerated, CounterName, CounterValue,Computer \\r\\n| summarize CPUTime = avg(CounterValue) by Computer, bin(TimeGenerated, 15m)\\r\\n| render timechart\",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"CPU % Total\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"Period\",\"timeBrushParameterName\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"linechart\"},\"customWidth\":\"50\",\"name\":\"query - 12\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nPerf\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| where ObjectName == \\\"System\\\" \\r\\n| where CounterName == \\\"Processor Queue Length\\\"\\r\\n| project TimeGenerated, CounterName, CounterValue,Computer \\r\\n| summarize CPUQueueLength = avg(CounterValue) by Computer, bin(TimeGenerated, 15m)\\r\\n| render timechart\",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"CPU Queue Length\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"timechart\"},\"customWidth\":\"50\",\"name\":\"query - 14\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nPerf\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| where ObjectName == \\\"Memory\\\" \\r\\n| where CounterName == \\\"Available MBytes\\\"\\r\\n| project TimeGenerated, CounterName, CounterValue,Computer \\r\\n| summarize AvailableMB = avg(CounterValue) by Computer, bin(TimeGenerated, 15m)\\r\\n| render areachart   \",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"Memory Available MBytes\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"]},\"customWidth\":\"50\",\"name\":\"query - 17\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nPerf\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| where ObjectName == \\\"Memory\\\" \\r\\n| where CounterName == \\\"Pages/sec\\\"\\r\\n| project TimeGenerated, CounterName, CounterValue,Computer \\r\\n| summarize PagesSec = avg(CounterValue) by Computer, bin(TimeGenerated, 15m)\\r\\n| render timechart\",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"Pages / second\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"]},\"customWidth\":\"50\",\"name\":\"query - 18\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"crossComponentResources\":[\"{Workspace}\"],\"parameters\":[{\"id\":\"94f176c5-f598-4e88-805d-f9f2fcc41504\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"LogicalDisk\",\"label\":\"Logical disk\",\"type\":5,\"isRequired\":true,\"query\":\"Perf\\r\\n| where ObjectName == \\\"LogicalDisk\\\" \\r\\n| where CounterName == \\\"% Free Space\\\" \\r\\n| summarize by InstanceName\\r\\n| where InstanceName !in (\\\"HarddiskVolume1\\\", \\\"_Total\\\")\",\"crossComponentResources\":[\"{Workspace}\"],\"value\":null,\"typeSettings\":{\"additionalResourceOptions\":[]},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 13\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nPerf\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| where ObjectName == \\\"LogicalDisk\\\" \\r\\n| where CounterName == \\\"Free Megabytes\\\"\\r\\n| where InstanceName == \\\"{LogicalDisk}\\\"\\r\\n| project TimeGenerated, CounterName, CounterValue,Computer \\r\\n| summarize FreeMBonC = avg(CounterValue) by Computer, bin(TimeGenerated, 15m)\\r\\n| render timechart\",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"Free space in MB\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"]},\"customWidth\":\"50\",\"name\":\"query - 21\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nPerf\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| where ObjectName == \\\"LogicalDisk\\\" \\r\\n| where CounterName == \\\"Current Disk Queue Length\\\"\\r\\n| where InstanceName == \\\"{LogicalDisk}\\\"\\r\\n| project TimeGenerated, CounterName, CounterValue,Computer \\r\\n| summarize DiskQueueLength = avg(CounterValue) by Computer, bin(TimeGenerated, 15m)\\r\\n| render timechart\",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"Disk Queue Length\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"]},\"customWidth\":\"50\",\"name\":\"query - 22\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"crossComponentResources\":[\"{Workspace}\"],\"parameters\":[{\"id\":\"269e2935-95bd-4916-bdd2-5721b95f7e8f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"NetworkAdapter\",\"label\":\"Network adapter\",\"type\":5,\"isRequired\":true,\"query\":\"Perf\\r\\n| where ObjectName == \\\"Network Adapter\\\" \\r\\n| where CounterName == \\\"Bytes Received/sec\\\" \\r\\n| summarize by InstanceName\",\"crossComponentResources\":[\"{Workspace}\"],\"value\":null,\"typeSettings\":{\"additionalResourceOptions\":[]},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 14\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nPerf\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| where ObjectName == \\\"Network Adapter\\\" \\r\\n| where CounterName == \\\"Bytes Received/sec\\\"\\r\\n| where InstanceName == \\\"{NetworkAdapter}\\\"\\r\\n| project TimeGenerated, CounterName, CounterValue,Computer \\r\\n| summarize BytesReceivedSec = avg(CounterValue) by Computer, bin(TimeGenerated, 15m)\\r\\n| render areachart\",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"Bytes Received/sec\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"]},\"customWidth\":\"50\",\"name\":\"query - 15\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ResourceGroupName = \\\"{ResourceGroup}\\\";\\r\\nPerf\\r\\n| where Computer contains \\\"{Computername}\\\"\\r\\n| where _ResourceId contains ResourceGroupName\\r\\n| where ObjectName == \\\"Network Adapter\\\" \\r\\n| where CounterName == \\\"Bytes Sent/sec\\\"\\r\\n| where InstanceName == \\\"{NetworkAdapter}\\\"\\r\\n| project TimeGenerated, CounterName, CounterValue,Computer \\r\\n| summarize BytesSentSec = avg(CounterValue) by Computer, bin(TimeGenerated, 15m)\\r\\n| render areachart\",\"size\":0,\"aggregation\":3,\"showAnalytics\":true,\"title\":\"Bytes Sent/sec\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"]},\"customWidth\":\"50\",\"name\":\"query - 16\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Perf\\r\\n| where Computer == \\\"{SelectedComputer}\\\"\\r\\n| where ObjectName == \\\"Process\\\" \\r\\n| where CounterName == \\\"% Processor Time\\\" \\r\\n| where InstanceName !in (\\\"_Total\\\", \\\"Idle\\\")\\r\\n| summarize Average = round(avg(CounterValue),2) by InstanceName \\r\\n| sort by Average desc \\r\\n| take 10\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 processes by CPU usage\",\"noDataMessage\":\"Please select machine in Availability percent grid.\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Average\",\"formatter\":3,\"formatOptions\":{\"palette\":\"lightBlue\",\"showIcon\":true}}]}},\"customWidth\":\"35\",\"name\":\"query - 17\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Perf\\r\\n| where Computer == \\\"{SelectedComputer}\\\"\\r\\n| where ObjectName == \\\"Process\\\" \\r\\n| where CounterName == \\\"Private Bytes\\\" \\r\\n| where InstanceName !in (\\\"_Total\\\", \\\"Idle\\\")\\r\\n| summarize AverageMB = round(avg(CounterValue/1024/1024),2) by InstanceName \\r\\n| sort by AverageMB desc \\r\\n| take 10\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 processes by Memory (MB) usage\",\"noDataMessage\":\"Please select machine in Availability percent grid.\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"AverageMB\",\"formatter\":3,\"formatOptions\":{\"palette\":\"grayBlue\",\"showIcon\":true}}]}},\"customWidth\":\"35\",\"name\":\"query - 18\"}],\"isLocked\":false,\"fallbackResourceIds\":[\"Azure Monitor\"]}",
                "version": "1.0",
                "sourceId": "[parameters('workbookSourceId')]",
                "category": "[parameters('workbookType')]"
            }
        }
    ],
    "outputs": {
        "workbookId": {
            "type": "string",
            "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
        }
    },
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"
}